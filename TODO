
Before each release of KolourPaint and/or KDE, grep sources for
"SYNC" and check that those assumptions still hold.

Look in BUGS, patches/, grep sources for "OPT" & "TODO" and look here:


KolourPaint 1.2 (10 days)
~~~~~~~~~~~~~~~~~~~~~~~~~~~

use of QPoint () or QPoint (-1, -1) as a sentinel is worrying since it's a
legal point when dragging out a rectangle


intersect bounding rect with document rect when saving undo info
- e.g. if you drag a large rect bigger than the view, waste a lot of memory
ditto for setTempPixmapAt et. al. (maybe not for selections, still thinking)

Bug: dragging a line extending outside of doc makes it transparent (RGB_A_ for PNG saves)
Hypothesis: kpPixmapFX::getPixmapAt() defines undefined pixels as transparent


1. creating new text selection sucks a lot of CPU
6. resizing doc flickers
7. emulate3buttons cancel
9. speed up drag scroll
7. resize doc or sel freehand and usershapepoints have , not x even though is dimen, not point
17. delayed kpcommand popupmenu creation
20. setup.bmp monochrome open and save loses a lot of info
verify gamma, check contrast,brightness,gamma order

option to dither image on open if not enough colors else that season jpg
looks bad on 8-bit screen
- it seems that AvoidDither means only do colour match/dithering if need to
  while PreferDither means try to _always_ smooth out (even in a single colour
  darkgreen document)
QColor::enterAllocContext () looks interesting
 
my unfinished patches in changes/ local


--------


Low Priority
------------

15. fix edit/paste may disappear due to klipper - Bug #85456
10. delta drawing of resize line to stop flicker
21. use KSaveFile for atomic writes - if the temp is put in the same place as
    dest, what about small media like floppy?
6. keyboard friendly scrollview


AUDITS
------

8-bit audit e.g. setPixel; looks like contrast effect has some sort of
rounding error causing e.g. a jump in colour range from 49 to 50

13. check kpcommandhistory INT_MAX overflow protection

16. check kpcommandhistory all sizes are correct

22. crash on close after playing with eps preview in save dialog


KolourPaint 1.4
~~~~~~~~~~~~~~~

componentisation

DCOP scriptable

m0ns00n@gmx.net:
- configurable palette size (up to 256 colours)  + <stephen.sweeney@lehman.com>
- generate gradient between 2 colours in palette

kpcolortoolbar - open/save palette

text tool could autoresize if font size changes or paste text
- maybe text selection could hold "userSetSize" as distinct from current size
  to allow e.g. auto increase box size for new font size, but then user changes
  mind and reverts to previous font size and the box snaps back

kpMainWindow::slotEnablePaste() is slow due to kpSelection::canDecode()
- QMimeSource::provides() sucks up most of the CPU (sometimes 4s),
  while QImageDrag::canDecode() usually takes up to 250ms.
- Trigger this by holding down CTRL+Printscreen
- best we can do is execute this check once per process (instead of per
  mainwWindow) and update all the mainWindows

Rethink kpView/kpViewManager design because of:
- performance
- problems with the image "sparkling" at zoom levels % 100 != 0
Ideas:
- region-based rendering (for performance)
- do something about this horrible tempPixmap hack (so slooooow)
Bug #6: modified states incorrectly set

draw rectangle and land on doc resize handle - wrong status mess
- that's a problem with Qt not giving EnterEvents when the mouse move is
  initiated from another object (see kpViewManager::viewUnderCursor() for
  the same problem)
  
allow user to hide Tool Box & Colour Palette if they really insist (it is possible to ALT+F4 them and can't get them back!)

sel border should not be xored against uninitialised rgb values (transparent pixels)
e.g. CTRL+A, Crop Outside the Selection

tool box icons should have same background color as the other controls

* kpSelection::setPixmap (QPixmap ()) hack allegedly for saving memory in commands
  backfires:
  - implicit sharing means that (most of the time), this isn't true
  - it forces kpSelection::calculateTransparencyMask() sloooowing things down

  - but then what about kpCommand::size()?

* kpsqueezedtextlabel could use (or be replaced by) KStringHandler::rPixelSqueeze()

* AUDIT "The QImage class uses explicit sharing, similar to that used by QMemArray."

spraycan should be continuous - merge with kpToolBrush base?
* [cleanup] remove all instances of kpTool*::setMode() - use proper class hierarchy

fix flicker when zooming in/out (Bug #1)

autocrop (moves top & left or just top; keep autocropping and undoing - nondeterministic???)

a better set of cursors that don't obscure the pixel you're drawing at
(e.g. compare the excellent Brush cursor to the Line Tool's cursor)

kptoolpreviewdialog shows checkerboard

config flaws:
- interprocess config propagation (grep for PROPAGATE) - surely this can be
  done easily without KUniqueApplication or DCOP?

config dialogs (look into new kconfig generator)
- open documents in same window mode
- recent files history length
- undo limit
- grid tiling
- visual transparency background
- saving transparency background
  (for formats like BMP which don't suport transparency)
- Un-DoNotAskAgain

bug: draw rectangle, drag out selection, undo - kills rect but not selection
is this a feature?

checkerboard + grid doesn't mix at certain zoom levels

Edit/Find a particular colour

"Open documents in the same window" mode - goes against what most KDE apps do
but it is convenient sometimes

tool/ruler (can even measure length & angle of diagonal lines)

Image menu items as ordinary tools - e.g. freehand rotate would be nice

kptoolwidgetbase - spacing between items, make contentsRect() actual size wanted

blur & sharpen

"a simple plugins framework that allows plugins to be written in various
languages (C, Python and Perl being the obvious choices) to allow people to
extend it into the realms of PaintShop Pro without impacting on the core
philosophy of the app, which seems to be simplicity." -- Tom

Brad.Grant@Glenayre.com's ideas:
- red-eye removal (see QImage for windows and LPhoto from Lindows (Bela-Andreas))

Bela-Andreas Bargel:
- kooka scanning
- greyscale masks

double click on transparent in colour tablet and press OK - becomes black

kpViewManager::setTextCursorBlinkState() needs to restart timer
kpToolText: cursor doesn't immediately appear after creating or moving
            a text box

When scrolling, text cursor is not fully repainted until next blink (Bug #14)

selections
- maybe always have 1 width display of border - try editing a B&W icon to see what I mean
- should be able to use selection/image commands on text box

eraser cursor border should not get magnified

tool to select rectangular area to zoom into

thumbnail has a rectangle that shows the visible mainView area

* Mike on Sunday 29/Feb/2004, @10:54:
  - A "Hand" tool which activates by keeping the "Space" key pressed
    down to scroll the visible part of the image around just like
    in Acrobat or Photoshop.
  - If that's the case then also on my wishlist for the next version:
    Automatic command line calling of ImageMagick to convert from png to gif
    so the user doesn't even notice there is no GIF support compiled in.
    No ImageMagick-dependency is needed - just call "convert" via exec.

    I know that most people hate GIF but as a web developer PNGs aren't a
    solution yet because of their awful buggy support in IE.

Emmeran Seehuber <rototor@rototor.de>
> The Escape-key
> could exit the input text mode, so that the other tools would be available
> again.

make sure session restore actually works


KDE 3.4
~~~~~~~

re-enable the ICO write support

multicolumn KToolBar's (Bug #3)


Other Ideas
~~~~~~~~~~~

KolourPaint at >= 1.0 should be very usable.  So the following are just nice
ideas (or things I should really do :)) that may or may not ever get
implemented:


guard all ptr derefs with if (ptr) ptr->whatever
- also don't store ptrs to e.g. kpDocument as they may go out of date

kdError -> KP_PANIC or KMessageBox
wait cursor for slow ops - should it be in kpDocument or in the commands???

With flow tools (pen, brush, spraycan), holding SHIFT forces horizontal drawing;
CTRL forces vertical - so those of us without perfectly steady hands
can still draw straight without continually hitting the Undo button :)

fill - can optimise mem usage by deleting kpFloodFill object
       when execute() (don't derive object)
     - can optimise mem usage by detecting single colour fills

ability to specify measurements in pt,mm,cm,m,in instead of just pixels

ruler

grid for zoom levels > 200 but % 100 != 0

maybe allow editing when a selection is active (selection becomes bounding rect)

offer to save Undo/Redo QPixmap's as PNGs to save memory

colour palette shows frequently used colours for the current image

readonly mode

network friendly - async save

line: shift+alt doesn't work but alt+shift does
- doesn't look like Bug #64019
- alt alone is backfiring anyway (conflicts with kwin)
  so I'll just leave 30deg & 60deg lines as hidden functionality for now
  (until I can think up a better key combo/way to activate it)

Colour Eraser as part of the Image Menu? You can dbl-click on the tool after all.

On open, dither alpha channel to mask?

Open 800x600 image, Skew, set horizontal to 60, vertical to 30 and play with
vertical and the image flips over!  I'm sure that's not supposed to happen.
Needs investigating.

Brad.Grant@Glenayre.com's ideas:
- rotating a JPG losslessly
- resampling a picture to enlarge it with quality choices (bilinear,
  bicubic, lanczos, ...)

view/preview OR view/fullscreen (not the same as settings/fullscreen)

mchristoph.eckert@t-online.de (Christoph Eckert):
shape selections should support CTRL, ALT, SHIFT to alter shape but
ATM, CTRL means copy, SHIFT means sweep.

if you undock a vertical toolbar and right click --> Orientation --> Bottom,
it stays vertically oriented

Look at KPixmapIO for QPixmap <-> QImage conversion optimisation
Update: qt-copy/patches/0005-qpixmap_mitshm.patch: "this obsoletes KPixmapIO"

Bela-Andreas Bargel:
- extra toolbar with slideshow and other image viewing options
- "CTRL-mousewheel" to zoom in/out of the window
- add a "info-button" (or menu-entry) which
  shows all (meta-)data about the image (eg. to set its
  dpi-resolution, its size, jpg/png-comments, colour
  mode, used colours, file size,EXIF-data...)
- add ksnapshot mode to paste grabbed thing directly into kolourpaint so
  that kolourpaint gets a "Take screenshot" menu item
- (LPhoto from Lindows): red-eye removal, enhance image

"brushes / stamps, hopefully configured from an external source.
 I.e. not only slanted lines and points of multiple thickness, but
 arbitrary images." - Dirk Schönberger
I want to avoid making the widgets too complicated but this sounds
like a very neat feature.

mchristoph.eckert@t-online.de (Christoph Eckert):
- Icons could be rearranged; drawing and editing tools should
  be grouped together instead of being spread over the toolbox

http://dot.kde.org/1078028599/:
* Anonymous on Sunday 29/Feb/2004, @09:15:
  - Free definable sizes for line thickness/spraycan/color eraser,
    line styles (dashed, dotted, ...),
    fill patterns, chooseable brushes, rulers

kde-apps.org:
* posthuman  on: 02/28/2004, 15:50
  - GIMP stuff like Crop Images and the intelligent scissor and a couple of more stuff.
